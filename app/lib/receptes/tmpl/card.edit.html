<div class="modal-body">
  <div class="container-fluid">
    <div ng-show="editor && showCode" class="row">
      <div class="col-lg-12">
        <pre class="pre-scrollable" style="word-wrap: break-word;" ng-click="selectText($event)">
{{ recipeCode }}
        </pre>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3 col-sm-4">
        <div class="recipe-image-area">
          <div class="recipe-photo" ng-show="recipe.mainPhoto">
            <img ng-src="{{ recipe.mainPhoto }}">
            <div ng-show="editor" class="remove-photo text-primary">
              <span class="glyphicon glyphicon-remove" ng-click="removeMainPhoto()"></span>
            </div>
          </div>
          <div class="photo-placeholder" ng-show="!recipe.mainPhoto">
            <div class="photo-placeholder-border">
              <i class="icon ion-images"></i><br />
              <span ng-show="editor" class="help-text">
                Arrosega una imatge<br />
                des de l'escriptori
              </span>
            </div>
          </div>
          <dropbox droppable="editor" on-drop="setMainRecipePhoto"></dropbox>
        </div>
        <div class="recipe-properties-area">
          <div ng-show="editor" class="customers">
            Ingredients per a: <input type="number" style="width: 48px;" ng-model="recipe.customersAmount" min="1" required>
          </div>
          <div ng-show="!editor" class="customers">
            Ingredients per a {{ recipe.customersAmount|persones }}
          </div>
          <div class="ingredient-list">
            <span>Llista d'ingredients:</span>
            <ul>
              <li ng-repeat="i in recipe.ingredients">
                {{ i|ingredient }}
                <span ng-show="editor" class="glyphicon glyphicon-pencil pointer" ng-click="openIngredientEditor(i)"></span>
                <span ng-show="editor" class="glyphicon glyphicon-remove pointer" ng-click="removeIngredient(i)"></span>
              </li>
            </ul>
          </div>
          <div class="recipe-ingredients">
            <button ng-show="editor && !addingNewIngredient" class="btn btn-primary btn-block" ng-click="openIngredientEditor()">
              <span class="glyphicon glyphicon-plus"></span>
              Afegir nou ingredient
            </button>
            <div ng-show="editor && addingNewIngredient" style="text-align: right;">
              <input type="hidden" ui-select2="nameSelector" ng-model="newIngredient.name" placeholder="Escriu l'ingredient que vols afegir" style="width: 100%; margin-bottom: 16px; text-align: left;">
              <div class="ingredient-value-type" ng-show="newIngredient.name">
                <div class="form-group">
                  <div class="input-group select2-bootstrap-prepend" style="margin-bottom: 16px;">
                    <div class="input-group-addon">
                      Mesura
                    </div>
                    <input type="hidden" class="form-control" ui-select2="measureSelector" placeholder="Seleccioni la mesura" ng-model="newIngredient.measure" style="text-align: left;">
                  </div>
                  <div class="input-group" ng-show="newIngredient.measure">
                    <div class="input-group-addon">
                      Quantitat
                    </div>
                    <input type="hidden" class="form-control" ui-select2="abstractMeasureSelector" placeholder="Selecciona quant vols" ng-model="newIngredient.quantity" ng-show="newIngredient.measure.id == 1" style="text-align: left;">
                    <input type="number" class="form-control" ng-model="newIngredient.quantity" placeholder="Escriu la quantitat de l'ingredient" ng-show="newIngredient.measure.id != 1">
                  </div>
                </div>
              </div>
              <button class="btn btn-success btn-sm" ng-show="newIngredient.name && newIngredient.measure && newIngredient.quantity" ng-click="createNewIngredient(newIngredient)">
                <span class="glyphicon glyphicon-ok"></span>
                <span ng-show="!ingredientBeingEdited">Crear nou ingredient</span>
                <span ng-show="ingredientBeingEdited">Desar els canvis</span>
              </button>
              <button class="btn btn-default btn-sm" ng-click="closeIngredientEditor()">
                <span class="glyphicon glyphicon-remove"></span>
                Cancel·lar
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-9 col-sm-8">
        <button class="btn btn-link btn-lg" style="position: absolute; top: 0; right: 0;" ng-click="closeEditor()">
          <span class="glyphicon glyphicon-remove"></span>
        </button>
        <div ng-show="editor">
          <button class="btn btn-default btn-sm" ng-click="viewRecipeCode()">
            <span class="glyphicon glyphicon-file"></span>
            Veure codi recepta
          </button>
          <!-- <a class="btn btn-default btn-sm" ng-click="downloadRecipeCode($event)">
            <span class="glyphicon glyphicon-cloud-download"></span>
            Descarregar codi recepta
          </a> -->
          <button class="btn btn-default btn-sm" ng-click="saveRecipe()">
            <span class="glyphicon glyphicon-floppy-disk"></span>
            Guardar
          </button>
          <button ng-show="!recipe.published" class="btn btn-default btn-sm" ng-click="publishRecipe()">
            <span class="glyphicon glyphicon-cloud-upload"></span>
            Publicar
          </button>
          <button class="btn btn-default btn-sm" ng-click="disableEditor()">
            <span class="glyphicon glyphicon-ok"></span>
            Finalitzar edició
          </button>
        </div>
        <div ng-show="!editor && userId == recipe.authorId">
          <button class="btn btn-default btn-sm" ng-click="enableEditor()">
            <span class="glyphicon glyphicon-pencil"></span>
            Editar la recepta
          </button>
        </div>
        <div class="recipe-body-content">
          <h1 contenteditable editable="editor" do-not-allow-line-breaks="true" placeholder="Escriu el títol de la recepta" ng-model="recipe.title"></h1>
          <div class="recipe-step row" ng-repeat="s in recipe.steps">
            <div class="col-lg-8 col-sm-6">
              <span ng-show="editor" class="glyphicon glyphicon-remove remove-step pointer" ng-click="removeRecipeStep(s)"></span>
              <h3 contenteditable editable="editor" do-not-allow-line-breaks="true" placeholder="Escriu el títol del pas" ng-model="s.title"></h3>
              <div contenteditable popline="true" editable="editor" placeholder="Escriu la descripció del pas de recepta" ng-model="s.description"></div>
            </div>
            <div ng-show="editor || s.photo" class="col-lg-4 col-sm-6">
              <div class="recipe-image-area">
                <div class="recipe-photo" ng-show="s.photo">
                  <img ng-src="{{ s.photo }}">
                  <div ng-show="editor" class="remove-photo text-primary">
                    <span class="glyphicon glyphicon-remove" ng-click="removeStepPhoto(s)"></span>
                  </div>
                </div>
                <div class="photo-placeholder" ng-show="!s.photo">
                  <div class="photo-placeholder-border">
                    <i class="icon ion-images"></i><br />
                    <span ng-show="editor" class="help-text">
                      Arrosega una imatge<br />
                      des de l'escriptori
                    </span>
                  </div>
                </div>
                <dropbox droppable="editor" on-drop-exp="setStepPhoto(s)"></dropbox>
              </div>
            </div>
          </div>
        </div>
        <button ng-show="editor" class="btn btn-primary btn-lg btn-block" ng-click="createRecipeStep()">
          <span class="glyphicon glyphicon-plus"></span>
          Afegir nou pas de recepta
        </button>
      </div>
    </div>
  </div>
</div>
